# Declarative Pipeline – Jenkins Notes

## Definition
Declarative Pipeline is a structured way to define CI/CD pipelines in a Jenkinsfile using predefined syntax blocks.

Used in: Jenkins  
Purpose: Build, Test, Deploy automation

---

# Basic Structure

pipeline {
    agent any

    stages {
        stage('Build') {
            steps {
                echo 'Building...'
            }
        }
    }
}

---

# Main Components of Declarative Pipeline

## 1. pipeline {}
- Root block
- Mandatory
- Only one allowed per Jenkinsfile

---

## 2. agent
Defines where the pipeline runs.

Types:
- any → Run on any available agent
- none → No global agent
- label → Specific node
- docker → Run inside Docker container

Example:
agent any

---

## 3. stages
- Container for all stages
- Mandatory block

---

## 4. stage
Defines a logical phase of pipeline.

Common stages:
- Build
- Test
- Deploy

Example:
stage('Test') {
    steps {
        sh 'npm test'
    }
}

---

## 5. steps
- Contains actual execution commands
- Runs shell scripts or Jenkins steps

Examples:
- sh
- bat
- echo
- script

---

## 6. environment
Defines environment variables.

Example:
environment {
    APP_ENV = "production"
}

Used for:
- API keys
- URLs
- Config values

---

## 7. parameters
Allows user input when triggering pipeline.

Example:
parameters {
    string(name: 'VERSION', defaultValue: '1.0')
}

---

## 8. post
Actions executed after pipeline/stage completion.

Conditions:
- always
- success
- failure
- unstable
- changed

Example:
post {
    success {
        echo 'Build Successful'
    }
}

---

## 9. options
Pipeline-level configuration.

Used for:
- Timeout
- Retry
- Disable concurrent builds

Example:
options {
    timeout(time: 30, unit: 'MINUTES')
}

---

## 10. triggers
Defines automatic build triggers.

Examples:
- SCM polling
- Webhook trigger
- Scheduled cron job

Example:
triggers {
    pollSCM('* * * * *')
}

---

## 11. when
Conditional stage execution.

Example:
stage('Deploy') {
    when {
        branch 'main'
    }
    steps {
        echo 'Deploying to production'
    }
}

Used for:
- Branch-based deployment
- Environment-based conditions

---

# Execution Flow

Pipeline Start
    ↓
Agent Allocation
    ↓
Stages Execute (Build → Test → Deploy)
    ↓
Post Actions Run
    ↓
Pipeline Ends

---

# Key Points

- Structured and readable syntax
- Easy to maintain
- Supports conditional execution
- Supports environment variables
- Supports build parameters
- Automatically integrates with SCM triggers

---

# Interview Summary

Declarative Pipeline in Jenkins is a structured CI/CD pipeline definition using predefined blocks like pipeline, agent, stages, steps, environment, parameters, post, options, triggers, and when. It improves readability and standardization compared to scripted pipelines.
